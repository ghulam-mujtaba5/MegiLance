domains:
- domain: megilance.site
  type: PRIMARY
  zone: megilance.site
- domain: www.megilance.site
  type: ALIAS
  zone: megilance.site
- domain: api.megilance.site
  type: ALIAS
  zone: megilance.site
ingress:
  rules:
  - component:
      name: backend
      preserve_path_prefix: true
    match:
      path:
        prefix: /api
  - component:
      name: backend
      preserve_path_prefix: true
    match:
      path:
        prefix: /backend
  - component:
      name: ai-service
      preserve_path_prefix: true
    match:
      path:
        prefix: /ai-api
  - component:
      name: frontend
    match:
      path:
        prefix: /
name: megilance
region: blr
services:
- dockerfile_path: backend/Dockerfile
  envs:
  - key: TURSO_DATABASE_URL
    scope: RUN_TIME
    value: libsql://megilance-db-megilance.aws-ap-south-1.turso.io
  - key: TURSO_AUTH_TOKEN
    scope: RUN_TIME
    type: SECRET
    value: EV[1:gybs67XrRqoVRlkacKcjY2OQ90QzIVVV:pTkfp0nEJ4EuItU1ManbhKf8WPtCtMFj6oeAjsi9t6GTfmpM6YrmvVhmnWrtXYIzI9hcqqFHmvhLXDO6ZNdwhOhUcyB1JXyCSYto+WO2Zg8pZGxgDPCoCEn1tf1w80GFmkOYnLxLF1zXYAbJ7wgm2r/CMLzwz3Kus7lfuA/6zBNC0nQZNQH6Pm/hwfANY+ZYFxDeCaCtYQ9PFTxjaRXK2Y4yX/Gi1/fkNq00AuNViWbr+PxeSIjuDGEjPPrtM2pvoRUICqlRgMl55kCwEh9b2cypDTkwM/HLSMi+gRY87N2JJMo//46ztQmAKlM7ABG9YRy0aGL+Y3xeIdSgMtPhKlYE7+6ey/f3gdh3tLuBbxAfgvxcv89WHuzipA==]
  - key: SECRET_KEY
    scope: RUN_TIME
    type: SECRET
    value: EV[1:5qQkMqwJa9bKpFe/9eXofTFo1/L7lJGN:ApcekRVw1eD4XUjKwjXjbVLtJWFdsJ3bBC3/xWFq9mmly16n4xgq9Ie243urB7pv2V7d9ai8KAwTQxzV9LfChM4IKk+E2qGVDi9pFQ==]
  - key: ENVIRONMENT
    scope: RUN_TIME
    value: production
  - key: CORS_ORIGINS
    scope: RUN_TIME
    value: https://megilance.site,https://www.megilance.site,https://api.megilance.site
  - key: BACKEND_CORS_ORIGINS
    scope: RUN_TIME
    value: '["https://megilance.site","https://www.megilance.site"]'
  - key: SLOWAPI_ENABLED
    scope: RUN_TIME
    value: "true"
  - key: AI_SERVICE_URL
    scope: RUN_TIME
    value: ${ai-service.PRIVATE_URL}:8001
  github:
    branch: main
    deploy_on_push: true
    repo: Mwaqarulmulk/MegiLance
  health_check:
    failure_threshold: 5
    http_path: /api/health/live
    initial_delay_seconds: 120
    period_seconds: 30
    success_threshold: 1
    timeout_seconds: 30
  http_port: 8000
  instance_count: 1
  instance_size_slug: basic-s
  name: backend
- dockerfile_path: ai/Dockerfile
  envs:
  - key: PORT
    scope: RUN_TIME
    value: "8001"
  - key: ENVIRONMENT
    scope: RUN_TIME
    value: production
  github:
    branch: main
    deploy_on_push: true
    repo: Mwaqarulmulk/MegiLance
  health_check:
    failure_threshold: 5
    http_path: /health
    initial_delay_seconds: 180
    period_seconds: 30
    success_threshold: 1
    timeout_seconds: 30
  http_port: 8001
  instance_count: 1
  instance_size_slug: basic-s
  name: ai-service
- dockerfile_path: frontend/Dockerfile
  envs:
  - key: NODE_ENV
    scope: RUN_AND_BUILD_TIME
    value: production
  - key: NEXT_TELEMETRY_DISABLED
    scope: RUN_AND_BUILD_TIME
    value: "1"
  - key: NEXT_PUBLIC_BACKEND_URL
    scope: RUN_AND_BUILD_TIME
    value: https://megilance.site
  - key: NEXT_PUBLIC_API_URL
    scope: RUN_AND_BUILD_TIME
    value: https://megilance.site/api
  - key: NEXT_PUBLIC_AI_URL
    scope: RUN_AND_BUILD_TIME
    value: https://megilance.site/ai-api
  - key: NEXT_PUBLIC_SHOW_DEMO_LOGIN
    scope: RUN_AND_BUILD_TIME
    value: "true"
  - key: NEXT_PUBLIC_DEV_ADMIN_EMAIL
    scope: RUN_AND_BUILD_TIME
    value: admin@megilance.com
  - key: NEXT_PUBLIC_DEV_ADMIN_PASSWORD
    scope: RUN_AND_BUILD_TIME
    value: Admin@123
  - key: NEXT_PUBLIC_DEV_CLIENT_EMAIL
    scope: RUN_AND_BUILD_TIME
    value: client1@example.com
  - key: NEXT_PUBLIC_DEV_CLIENT_PASSWORD
    scope: RUN_AND_BUILD_TIME
    value: Client@123
  - key: NEXT_PUBLIC_DEV_FREELANCER_EMAIL
    scope: RUN_AND_BUILD_TIME
    value: freelancer1@example.com
  - key: NEXT_PUBLIC_DEV_FREELANCER_PASSWORD
    scope: RUN_AND_BUILD_TIME
    value: Freelancer@123
  - key: NEXT_PUBLIC_APP_URL
    scope: RUN_AND_BUILD_TIME
    value: https://megilance.site
  - key: GOOGLE_SITE_VERIFICATION
    scope: RUN_AND_BUILD_TIME
    value: AiJ_ApfC0MGXqy36O_JGpOol_z0i0b8X0J3x3YuyhKs
  github:
    branch: main
    deploy_on_push: true
    repo: Mwaqarulmulk/MegiLance
  health_check:
    failure_threshold: 5
    http_path: /
    initial_delay_seconds: 60
    period_seconds: 30
    success_threshold: 1
    timeout_seconds: 10
  http_port: 3000
  instance_count: 1
  instance_size_slug: basic-xs
  name: frontend
